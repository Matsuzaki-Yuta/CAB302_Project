<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<AnchorPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.app.studysnap.controllers.QuizGeneratorController"
            stylesheets="@styles/quizGen.css"
            prefWidth="1100" prefHeight="760">
    <children>
        <VBox spacing="16.0" AnchorPane.topAnchor="16" AnchorPane.leftAnchor="16"
              AnchorPane.rightAnchor="16" AnchorPane.bottomAnchor="16">

            <!-- Title & Subtitle -->
            <VBox spacing="4">
                <Label text="Quiz Generator" styleClass="title"/>
                <Label text="Create your multiple-question custom quiz" styleClass="subtitle"/>
            </VBox>

            <!-- Tabs: Upload, Paste, Prompt, Download Public -->
            <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE">
                <!-- Upload -->
                <Tab text="Upload content">
                    <content>
                        <VBox spacing="12">
                            <padding><Insets top="12" right="12" bottom="12" left="12"/></padding>

                            <Label text="Upload a PDF/TXT file to generate questions from." styleClass="muted"/>

                            <StackPane fx:id="fileDropZone" prefHeight="160" styleClass="dropzone">
                                <children>
                                    <VBox alignment="CENTER" spacing="8">
                                        <Label text="Drop file here" styleClass="dropzone-title"/>
                                        <Label text="or" styleClass="muted"/>
                                        <Button fx:id="chooseFileBtn" text="Choose file…" onAction="#onChooseFile" styleClass="primary"/>
                                        <Label fx:id="chosenFileLabel" text="No file selected" styleClass="muted"/>
                                    </VBox>
                                </children>
                            </StackPane>

                            <HBox spacing="8">
                                <Button text="GENERATE" onAction="#onGenerateFromUpload" styleClass="primary"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <CheckBox fx:id="includeAnswersUpload" text="Include answers in preview" selected="true"/>
                            </HBox>
                        </VBox>
                    </content>
                </Tab>

                <!-- Paste -->
                <Tab text="Paste text">
                    <content>
                        <VBox spacing="12">
                            <padding><Insets top="12" right="12" bottom="12" left="12"/></padding>

                            <Label text="Paste source text below." styleClass="muted"/>
                            <TextArea fx:id="pastedTextArea" prefRowCount="12" promptText="Paste text here…" wrapText="true"/>

                            <HBox spacing="8">
                                <Button text="GENERATE" onAction="#onGenerateFromPaste" styleClass="primary"/>
                                <Button text="RESET" onAction="#onResetPaste"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <CheckBox fx:id="includeAnswersPaste" text="Include answers in preview" selected="true"/>
                            </HBox>
                        </VBox>
                    </content>
                </Tab>

                <!-- Prompt (MCQ assumed) -->
                <Tab text="Enter prompt">
                    <content>
                        <VBox spacing="12">
                            <padding><Insets top="12" right="12" bottom="12" left="12"/></padding>

                            <Label text="Describe the topic" styleClass="muted"/>
                            <TextArea fx:id="promptTextArea" prefRowCount="8"
                                      promptText="e.g., “Generate quiz on Java basics for beginners.”"
                                      wrapText="true"/>

                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Region HBox.hgrow="ALWAYS"/>
                                <CheckBox fx:id="includeAnswersPrompt" text="Include answers in preview" selected="true"/>
                            </HBox>

                            <HBox spacing="8">
                                <Button text="GENERATE" onAction="#onGenerateFromPrompt" styleClass="primary"/>
                                <Button text="RESET" onAction="#onResetPrompt"/>
                            </HBox>
                        </VBox>
                    </content>
                </Tab>

                <!-- Download public -->
                <Tab text="Download public">
                    <content>
                        <VBox spacing="10">
                            <padding><Insets top="12" right="12" bottom="12" left="12"/></padding>

                            <HBox spacing="8" alignment="CENTER_LEFT">
                                <TextField fx:id="searchField" promptText="Search quizzes by name/subject"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="Refresh" onAction="#onRefreshPublic"/>
                                <Button text="Download Selected" onAction="#onDownloadSelected" styleClass="primary"/>
                            </HBox>

                            <TableView fx:id="publicTable" prefHeight="260">
                                <columns>
                                    <TableColumn fx:id="colName" text="Quiz Name" prefWidth="260"/>
                                    <TableColumn fx:id="colSubject" text="Subject" prefWidth="200"/>
                                    <TableColumn fx:id="colDescription" text="Description" prefWidth="320"/>
                                    <TableColumn fx:id="colAuthor" text="Author" prefWidth="180"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </content>
                </Tab>
            </TabPane>

            <!-- Preview & Actions (no autofill; you can paste/edit manually) -->
            <VBox spacing="8">
                <Label text="Preview &amp; Edit" styleClass="section-title"/>
                <TextArea fx:id="previewArea"
                          promptText="Paste or edit your quiz here before saving."
                          wrapText="true" prefRowCount="14"/>
                <HBox spacing="8">
                    <Button text="Save to My Quizzes" onAction="#onSave" styleClass="success"/>
                    <Button text="Export PDF" onAction="#onExportPdf"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <ProgressIndicator fx:id="progress" visible="false" prefWidth="22" prefHeight="22"/>
                </HBox>
            </VBox>

        </VBox>
    </children>
</AnchorPane>
